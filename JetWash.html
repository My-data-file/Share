<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aplikasi Laundry UX Pro</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
/* --- Body & Header --- */
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding-bottom: 70px;
  background-color: #f0f4f8;
  overflow-x: hidden;
}
h1 { text-align:center; color:#007bff; margin:15px 0; font-size:1.6em; }

/* --- Tab content --- */
.tab-content {
  display: none;
  padding: 15px 10px 10px 10px;
  background-color: #fff;
  border-radius: 0 0 12px 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.1);
  margin-bottom: 10px;
  max-height: calc(100vh - 130px);
  overflow-y: auto;
  transition: all 0.3s ease-in-out;
}
.tab-content.active { display: block; opacity:1; transform: translateY(0); }

/* --- Bottom Navigation --- */
.tabs {
  display: flex;
  justify-content: space-around;
  position: fixed;
  bottom: 0; left:0; right:0;
  height:60px;
  background-color:#fff;
  border-top:1px solid #ddd;
  box-shadow:0 -2px 6px rgba(0,0,0,0.1);
  z-index:1000;
  font-size:0.75em;
}
.tab {
  flex:1; text-align:center; padding-top:5px; cursor:pointer;
  transition: all 0.2s;
}
.tab.active {
  color:#007bff; font-weight:bold;
  border-top:3px solid #007bff;
  background-color:#f0f4f8;
}
.tab:hover { background-color:#e6ecf3; }
.tab-icon{ font-size:1.2em; display:block; }
.tab-text{ font-size:0.75em; display:block; margin-top:2px; }

/* --- Form inputs --- */
.form-section input,.form-section select,.form-section textarea{
  width:100%; padding:8px; margin:5px 0;
  border:1px solid #ccc; border-radius:6px; font-size:0.9em;
}
.form-section input:focus,.form-section select:focus,.form-section textarea:focus{
  outline:none; border-color:#007bff; box-shadow:0 0 4px rgba(0,123,255,0.3);
}
textarea{ resize:vertical; min-height:50px; }

/* --- Buttons --- */
.form-section button{
  margin:5px 5px 5px 0; padding:8px 14px; cursor:pointer;
  border:none; border-radius:8px; color:#fff;
  background:linear-gradient(145deg,#007bff,#0056b3);
  font-size:0.9em; transition: all 0.2s;
}
.form-section button:hover{
  background:linear-gradient(145deg,#0056b3,#007bff);
  transform: translateY(-1px);
}

/* --- Card --- */
.card{
  border:1px solid #ddd; padding:10px 12px; margin:6px 0;
  border-radius:12px; background-color:#fff;
  box-shadow:0 2px 6px rgba(0,0,0,0.08);
  word-break:break-word; font-size:0.85em;
  transition: transform 0.3s, box-shadow 0.3s;
  cursor:pointer;
}
.card:hover{ transform: translateY(-2px); box-shadow:0 4px 14px rgba(0,0,0,0.15); }

/* --- Card Details Animasi --- */
.card-details {
  max-height: 0;
  overflow: hidden;
  margin-top: 5px;
  font-size: 0.82em;
  color: #333;
  transition: max-height 0.3s ease, opacity 0.3s ease;
  opacity: 0;
}
.card.expanded .card-details {
  max-height: 500px; /* cukup besar untuk konten */
  opacity: 1;
}

/* --- Foto Animasi --- */
.card-details img {
  max-width: 70px;
  max-height: 70px;
  border-radius: 8px;
  object-fit: cover;
  border: 1px solid #ccc;
  transition: transform 0.3s ease, opacity 0.3s ease;
  transform: translateY(-10px);
  opacity: 0;
}
.card.expanded .card-details img {
  transform: translateY(0);
  opacity: 1;
}

/* --- Foto preview --- */
.foto-preview{ margin-top:4px; }
.foto-preview img{
  max-width:70px; max-height:70px; border-radius:8px;
  object-fit:cover; border:1px solid #ccc;
}

/* --- Scrollbar custom --- */
.tab-content::-webkit-scrollbar{ width:6px; }
.tab-content::-webkit-scrollbar-track{ background:#f0f4f8; }
.tab-content::-webkit-scrollbar-thumb{ background:#ccc; border-radius:3px; }

/* --- Responsive --- */
@media (max-width:480px){
  .form-section input,.form-section select,.form-section textarea{ font-size:0.85em; padding:6px; }
  .form-section button{ width:100%; margin-bottom:6px; font-size:0.85em; padding:7px; }
  .card{ font-size:0.8em; padding:8px 10px; }
  .foto-preview img{ max-width:60px; max-height:60px; }
  .card-details img{ max-width:60px; max-height:60px; }
}
</style>
</head>
<body>

<h1>üìå Aplikasi Laundry</h1>

<div class="tabs">
  <div class="tab active" data-tab="absenTab"><span class="tab-icon">üìù</span><br><span class="tab-text">Absen</span></div>
  <div class="tab" data-tab="hasilTab"><span class="tab-icon">üß∫</span><br><span class="tab-text">Laundry</span></div>
  <div class="tab" data-tab="komplainTab"><span class="tab-icon">‚ö†Ô∏è</span><br><span class="tab-text">Komplain</span></div>
</div>

<!-- Absen Tab -->
<div id="absenTab" class="tab-content form-section active">
  <h2>Form Absen</h2>
  <form id="absenForm">
    <input type="text" id="namaPegawai" placeholder="Nama Pegawai" required>
    <input type="date" id="tanggalAbsen" required>
    <input type="time" id="jamAbsen" required>
    <select id="tipeAbsen">
      <option value="Masuk">Masuk</option>
      <option value="Pulang">Pulang</option>
    </select>
    <input type="file" id="fotoAbsen" accept="image/*">
    <div id="fotoAbsenPreview" class="foto-preview"></div>
    <button type="submit">Simpan</button>
    <button type="button" id="savePdfAbsenBtn" style="display:none;">Simpan PDF</button>
    <button type="button" id="resetAbsenBtn" style="display:none;">Reset</button>
  </form>
  <div id="cardsAbsen"></div>
</div>

<!-- Hasil Laundry Tab -->
<div id="hasilTab" class="tab-content form-section">
  <h2>Form Hasil Laundry</h2>
  <form id="hasilForm">
    <input type="text" id="namaPelangganHasil" placeholder="Nama Pelanggan" required>
    <input type="number" id="beratLaundry" placeholder="Berat (kg)" required>
    <input type="number" id="baju" placeholder="Jumlah Baju" required>
    <input type="number" id="celana" placeholder="Jumlah Celana" required>
    <input type="number" id="jaket" placeholder="Jumlah Jaket" required>
    <input type="number" id="total" placeholder="Total Harga" required>
    <input type="date" id="tanggalSelesai" required>
    <input type="time" id="jamMulai" required>
    <input type="time" id="jamSelesai" required>
    <button type="submit">Simpan</button>
    <button type="button" id="savePdfLaundryBtn" style="display:none;">Simpan PDF</button>
    <button type="button" id="resetLaundryBtn" style="display:none;">Reset Laundry</button>
  </form>
  <div id="cardsHasilLaundry"></div>
</div>

<!-- Komplain Tab -->
<div id="komplainTab" class="tab-content form-section">
  <h2>Form Komplain</h2>
  <form id="komplainForm">
    <input type="text" id="namaPelanggan" placeholder="Nama Pelanggan" required>
    <input type="date" id="tanggalKomplain" required>
    <input type="time" id="jamKomplain" required>
    <textarea id="komplainText" placeholder="Isi Komplain" required></textarea>
    <input type="file" id="fotoKomplain" accept="image/*">
    <div id="fotoPreview" class="foto-preview"></div>
    <button type="submit">Simpan</button>
    <button type="button" id="savePdfKomplainBtn" style="display:none;">Simpan PDF</button>
    <button type="button" id="resetKomplainBtn" style="display:none;">Reset Komplain</button>
  </form>
  <div id="cardsKomplain"></div>
</div>

<script>
// --- Tab Menu ---
document.querySelectorAll('.tab').forEach(tab=>{
  tab.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c=>{
      c.classList.remove('active');
      c.style.opacity=0; c.style.transform='translateY(20px)';
    });
    tab.classList.add('active');
    const target=document.getElementById(tab.dataset.tab);
    target.classList.add('active');
    setTimeout(()=>{ target.style.opacity=1; target.style.transform='translateY(0)'; },50);
  });
});

// --- Preview Foto ---
function previewFoto(inputId, previewId){
  document.getElementById(inputId).addEventListener('change', function(e){
    const reader = new FileReader();
    reader.onload = function(ev){
      document.getElementById(previewId).innerHTML = '<img src="'+ev.target.result+'">';
      document.getElementById(previewId).dataset.img = ev.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  });
}
previewFoto('fotoAbsen','fotoAbsenPreview');
previewFoto('fotoKomplain','fotoPreview');

// --- Load Cards ---
function loadCards(key,targetId,fields){
  const data=JSON.parse(localStorage.getItem(key))||[];
  const container=document.getElementById(targetId);
  container.innerHTML="";
  data.forEach((d,i)=>{
    const card=document.createElement("div");
    card.className="card";
    let mainHTML=`<strong>${fields[0]}:</strong> ${d[fields[0]]}`;
    let detailsHTML='';
    fields.slice(1).forEach(f=>{
      if(f==='foto' && d[f]) detailsHTML+=`<div><img src="${d[f]}" width="70"></div>`;
      else detailsHTML+=`<div><strong>${f}:</strong> ${d[f]}</div>`;
    });
    card.innerHTML=mainHTML+`<div class="card-details">${detailsHTML}</div>`;
    card.addEventListener('click',()=>{ card.classList.toggle('expanded'); });
    container.appendChild(card);
  });
}

// --- Update buttons ---
function updateAbsenButtons(){ const data=JSON.parse(localStorage.getItem('absen'))||[]; document.getElementById('savePdfAbsenBtn').style.display = data.length>0 ? "inline-block":"none"; document.getElementById('resetAbsenBtn').style.display = data.length>0 ? "inline-block":"none"; }
function updateLaundryButtons(){ const data=JSON.parse(localStorage.getItem('hasilLaundry'))||[]; document.getElementById('savePdfLaundryBtn').style.display = data.length>0 ? "inline-block":"none"; document.getElementById('resetLaundryBtn').style.display = data.length>0 ? "inline-block":"none"; }
function updateKomplainButtons(){ const data=JSON.parse(localStorage.getItem('komplain'))||[]; document.getElementById('savePdfKomplainBtn').style.display = data.length>0 ? "inline-block":"none"; document.getElementById('resetKomplainBtn').style.display = data.length>0 ? "inline-block":"none"; }
function updateButtons(){ loadCards('absen','cardsAbsen',['nama','tanggal','jam','tipe','foto']); loadCards('hasilLaundry','cardsHasilLaundry',['nama','berat','baju','celana','jaket','total','tanggalSelesai','jamMulai','jamSelesai']); loadCards('komplain','cardsKomplain',['nama','tanggal','jam','isi','foto']); updateAbsenButtons(); updateLaundryButtons(); updateKomplainButtons(); }
updateButtons();

// --- Form Submits (perbaikan fetch kompatibel HP/laptop) ---
function sendToScript(type,payload){
  fetch("https://script.google.com/macros/s/AKfycbyvsgvqyFKq2Z1jzWMfPM7x44IS-KDbluIAtHO2Xy2ULkROHBdLM4bUr7UDyxXBTya1Bw/exec",{
    method:"POST",
    body: JSON.stringify({type:type,payload:payload})
  }).catch(err=>console.error(err));
}

document.getElementById('absenForm').addEventListener('submit',function(e){
  e.preventDefault();
  const nama=document.getElementById('namaPegawai').value;
  const tanggal=document.getElementById('tanggalAbsen').value;
  const jam=document.getElementById('jamAbsen').value;
  const tipe=document.getElementById('tipeAbsen').value;
  const foto=document.getElementById('fotoAbsenPreview').dataset.img||'';
  let data=JSON.parse(localStorage.getItem('absen'))||[];
  data.push({nama,tanggal,jam,tipe,foto});
  localStorage.setItem('absen',JSON.stringify(data));
  sendToScript("absen",{nama,tanggal,jam,tipe,foto});
  this.reset();
  document.getElementById('fotoAbsenPreview').textContent='';
  document.getElementById('fotoAbsenPreview').dataset.img='';
  updateButtons();
});

document.getElementById('hasilForm').addEventListener('submit',function(e){
  e.preventDefault();
  const nama=document.getElementById('namaPelangganHasil').value;
  const berat=document.getElementById('beratLaundry').value;
  const baju=document.getElementById('baju').value;
  const celana=document.getElementById('celana').value;
  const jaket=document.getElementById('jaket').value;
  const total=document.getElementById('total').value;
  const tanggalSelesai=document.getElementById('tanggalSelesai').value;
  const jamMulai=document.getElementById('jamMulai').value;
  const jamSelesai=document.getElementById('jamSelesai').value;
  let data=JSON.parse(localStorage.getItem('hasilLaundry'))||[];
  data.push({nama,berat,baju,celana,jaket,total,tanggalSelesai,jamMulai,jamSelesai});
  localStorage.setItem('hasilLaundry',JSON.stringify(data));
  sendToScript("hasilLaundry",{nama,berat,baju,celana,jaket,total,tanggalSelesai,jamMulai,jamSelesai});
  this.reset();
  document.getElementById('total').value='';
  updateButtons();
});

document.getElementById('komplainForm').addEventListener('submit',function(e){
  e.preventDefault();
  const nama=document.getElementById('namaPelanggan').value;
  const tanggal=document.getElementById('tanggalKomplain').value;
  const jam=document.getElementById('jamKomplain').value;
  const isi=document.getElementById('komplainText').value;
  const foto=document.getElementById('fotoPreview').dataset.img||'';
  let data=JSON.parse(localStorage.getItem('komplain'))||[];
  data.push({nama,tanggal,jam,isi,foto});
  localStorage.setItem('komplain',JSON.stringify(data));
  sendToScript("komplain",{nama,tanggal,jam,isi,foto});
  this.reset();
  document.getElementById('fotoPreview').textContent='';
  document.getElementById('fotoPreview').dataset.img='';
  updateButtons();
});

// --- Reset & PDF buttons tetap sama ---
document.getElementById('resetAbsenBtn').addEventListener('click',()=>{if(confirm("Yakin reset semua data Absen?")){ localStorage.removeItem('absen'); updateButtons(); alert("Data Absen berhasil di-reset!"); }});
document.getElementById('savePdfAbsenBtn').addEventListener('click',()=>{ const { jsPDF } = window.jspdf; const data=JSON.parse(localStorage.getItem('absen'))||[]; if(data.length>0){ const doc=new jsPDF(); let y=20; doc.setFontSize(12); doc.text("Data Absen",10,10); doc.text("No",10,y); doc.text("Nama",20,y); doc.text("Tanggal",70,y); doc.text("Jam",110,y); doc.text("Tipe",140,y); doc.text("Foto",170,y); y+=10; data.forEach((d,i)=>{ if(y>270){ doc.addPage(); y=20; doc.text("No",10,y); doc.text("Nama",20,y); doc.text("Tanggal",70,y); doc.text("Jam",110,y); doc.text("Tipe",140,y); doc.text("Foto",170,y); y+=10; } doc.text(String(i+1),10,y); doc.text(d.nama,20,y); doc.text(d.tanggal,70,y); doc.text(d.jam,110,y); doc.text(d.tipe,140,y); if(d.foto) doc.addImage(d.foto,'JPEG',170,y-7,20,15); y+=10;}); doc.save("data_absen.pdf"); }});

document.getElementById('resetLaundryBtn').addEventListener('click',()=>{if(confirm("Yakin reset semua data Hasil Laundry?")){ localStorage.removeItem('hasilLaundry'); updateButtons(); alert("Data Hasil Laundry berhasil di-reset!"); }});
document.getElementById('savePdfLaundryBtn').addEventListener('click',()=>{ const { jsPDF } = window.jspdf; const data=JSON.parse(localStorage.getItem('hasilLaundry'))||[]; if(data.length>0){ const doc=new jsPDF(); let y=20; doc.setFontSize(12); doc.text("Data Hasil Laundry",10,10); doc.text("No",10,y); doc.text("Nama",20,y); doc.text("Berat",70,y); doc.text("Baju",100,y); doc.text("Celana",120,y); doc.text("Jaket",140,y); doc.text("Total",160,y); y+=10; data.forEach((d,i)=>{ if(y>270){ doc.addPage(); y=20; doc.text("No",10,y); doc.text("Nama",20,y); doc.text("Berat",70,y); doc.text("Baju",100,y); doc.text("Celana",120,y); doc.text("Jaket",140,y); doc.text("Total",160,y); y+=10; } doc.text(String(i+1),10,y); doc.text(d.nama,20,y); doc.text(d.berat,70,y); doc.text(d.baju,100,y); doc.text(d.celana,120,y); doc.text(d.jaket,140,y); doc.text(d.total,160,y); y+=10;}); doc.save("data_hasil_laundry.pdf"); }});

document.getElementById('resetKomplainBtn').addEventListener('click',()=>{if(confirm("Yakin reset semua data Komplain?")){ localStorage.removeItem('komplain'); updateButtons(); alert("Data Komplain berhasil di-reset!"); }});
document.getElementById('savePdfKomplainBtn').addEventListener('click',()=>{ const { jsPDF } = window.jspdf; const data=JSON.parse(localStorage.getItem('komplain'))||[]; if(data.length>0){ const doc=new jsPDF(); let y=20; doc.setFontSize(12); doc.text("Data Komplain",10,10); doc.text("No",10,y); doc.text("Nama",20,y); doc.text("Tanggal",70,y); doc.text("Jam",110,y); doc.text("Isi",140,y); doc.text("Foto",180,y); y+=10; data.forEach((d,i)=>{ if(y>270){ doc.addPage(); y=20; doc.text("No",10,y); doc.text("Nama",20,y); doc.text("Tanggal",70,y); doc.text("Jam",110,y); doc.text("Isi",140,y); doc.text("Foto",180,y); y+=10; } doc.text(String(i+1),10,y); doc.text(d.nama,20,y); doc.text(d.tanggal,70,y); doc.text(d.jam,110,y); doc.text(d.isi,140,y); if(d.foto) doc.addImage(d.foto,'JPEG',180,y-7,15,10); y+=10;}); doc.save("data_komplain.pdf"); }});
</script>

</body>
</html>
