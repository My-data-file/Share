<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>JETWASH LAUNDRY</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f2f2f2; }
  header { background:#0077cc; color:white; padding:15px; text-align:center; font-size:1.5em; font-weight:bold; }
  nav { display:flex; background:#004d80; justify-content:space-around; flex-wrap:wrap; }
  nav button { flex:1; padding:15px; background:#004d80; border:none; color:white; cursor:pointer; transition: all 0.2s ease-in-out; }
  nav button:hover { background:#006bb3; }
  nav button.active-menu { background: linear-gradient(135deg, #0077cc, #00aaff); box-shadow: 0 4px 8px rgba(0,0,0,0.3); transform: scale(1.05); }
  .content { padding:20px; }
  .section { display:none; }
  .active { display:block; }
  .form-group { margin-bottom:15px; }
  label { display:block; margin-bottom:5px; font-weight:bold; }
  input[type="text"], input[type="date"], input[type="time"], input[type="number"], textarea { width:100%; padding:10px; box-sizing:border-box; }
  .btnSimpan { background:#0077cc; color:white; border:none; padding:10px 20px; cursor:pointer; border-radius:5px; margin-top:10px; }
  .btnSimpan:hover { background:#005fa3; }
  #resetHasilLaundry, #resetAbsen, #resetKomplain { background:#cc0000; }
  .cards { display:flex; flex-direction:column; gap:10px; margin-top:15px; }
  .card { background:white; padding:10px 15px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
  .card p { margin:5px 0; }
  img.card-img { max-width:100%; border-radius:5px; margin-top:5px; }
  @media (max-width:600px){ nav button{ font-size:0.9em; padding:12px; } }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<header>JETWASH LAUNDRY</header>

<nav>
  <button onclick="showSection('absen')">Absen</button>
  <button onclick="showSection('hasil')">Hasil Laundry</button>
  <button onclick="showSection('komplain')">Komplain</button>
</nav>

<div class="content">

  <!-- Absen Section -->
  <div id="absen" class="section active">
    <h2>Form Absen Pegawai</h2>
    <form id="absenForm">
      <div class="form-group">
        <label for="namaPegawai">Nama Pegawai:</label>
        <input type="text" id="namaPegawai" required>
      </div>
      <div class="form-group">
        <label for="tanggalAbsen">Tanggal:</label>
        <input type="date" id="tanggalAbsen" required>
      </div>
      <div class="form-group">
        <label for="jamAbsen">Jam:</label>
        <input type="time" id="jamAbsen" required>
      </div>
      <div class="form-group">
        <label>Foto Absen (opsional):</label><br>
        <button type="button" class="btnSimpan" onclick="document.getElementById('fotoAbsen').click()">üì∑ Ambil Foto</button>
        <input type="file" id="fotoAbsen" accept="image/*" capture="environment" style="display:none;">
        <p id="fotoAbsenPreview" style="margin-top:10px; font-size:14px; color:#555;"></p>
      </div>
      <button type="submit" class="btnSimpan">Kirim Absen</button>
    </form>
    <h3>Data Absen</h3>
    <div id="cardsAbsen" class="cards"></div>
    <button id="simpanSemuaPDFAbsen" class="btnSimpan" style="display:none;">üíæ Simpan Semua PDF Absen</button>
    <button id="resetAbsen" class="btnSimpan" style="display:none;">‚ö†Ô∏è Reset Data Absen</button>
  </div>

  <!-- Hasil Laundry Section -->
  <div id="hasil" class="section">
    <h2>Hasil Laundry</h2>
    <form id="hasilForm">
      <div class="form-group">
        <label for="namaPelangganHasil">Nama Pelanggan:</label>
        <input type="text" id="namaPelangganHasil" required>
      </div>
      <div class="form-group">
        <label for="beratLaundry">Berat Laundry (kg):</label>
        <input type="text" id="beratLaundry" required>
      </div>
      <div class="form-group">
        <label>Jumlah Pakaian:</label>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <div style="flex:1; min-width:100px;">
            <label for="baju">Baju (pcs)</label>
            <input type="number" id="baju" min="0" required>
          </div>
          <div style="flex:1; min-width:100px;">
            <label for="celana">Celana (pcs)</label>
            <input type="number" id="celana" min="0" required>
          </div>
          <div style="flex:1; min-width:100px;">
            <label for="jaket">Jaket (pcs)</label>
            <input type="number" id="jaket" min="0" required>
          </div>
        </div>
      </div>
      <div class="form-group">
        <label for="total">Total Pakaian (pcs)</label>
        <input type="number" id="total" readonly>
      </div>
      <div class="form-group">
        <label for="tanggalSelesai">Tanggal Selesai:</label>
        <input type="date" id="tanggalSelesai" required>
      </div>
      <div class="form-group">
        <label for="jamMulai">Jam Mulai:</label>
        <input type="time" id="jamMulai" required>
      </div>
      <div class="form-group">
        <label for="jamSelesai">Jam Selesai:</label>
        <input type="time" id="jamSelesai" required>
      </div>
      <button type="submit" class="btnSimpan">Simpan Hasil</button>
    </form>

    <h3>Data Hasil Laundry</h3>
    <div id="cardsHasilLaundry" class="cards"></div>
    <button id="simpanSemuaPDFHasil" class="btnSimpan" style="display:none;">üíæ Simpan Semua PDF Hasil Laundry</button>
    <button id="resetHasilLaundry" class="btnSimpan" style="display:none;">‚ö†Ô∏è Reset Data Hasil Laundry</button>
  </div>

  <!-- Komplain Section -->
  <div id="komplain" class="section">
    <h2>Form Komplain Pelanggan</h2>
    <form id="komplainForm">
      <div class="form-group">
        <label for="namaPelanggan">Nama Pelanggan:</label>
        <input type="text" id="namaPelanggan" required>
      </div>
      <div class="form-group">
        <label for="tanggalKomplain">Tanggal:</label>
        <input type="date" id="tanggalKomplain" required>
      </div>
      <div class="form-group">
        <label for="jamKomplain">Jam:</label>
        <input type="time" id="jamKomplain" required>
      </div>
      <div class="form-group">
        <label for="komplainText">Isi Komplain:</label>
        <textarea id="komplainText" rows="4" required></textarea>
      </div>
      <div class="form-group">
        <label>Foto Komplain (opsional):</label><br>
        <button type="button" class="btnSimpan" onclick="document.getElementById('fotoKomplain').click()">üì∑ Ambil Foto</button>
        <input type="file" id="fotoKomplain" accept="image/*" capture="environment" style="display:none;">
        <p id="fotoPreview" style="margin-top:10px; font-size:14px; color:#555;"></p>
      </div>
      <button type="submit" class="btnSimpan">Kirim Komplain</button>
    </form>
    <h3>Data Komplain</h3>
    <div id="cardsKomplain" class="cards"></div>
    <button id="simpanSemuaPDFKomplain" class="btnSimpan" style="display:none;">üíæ Simpan Semua PDF Komplain</button>
    <button id="resetKomplain" class="btnSimpan" style="display:none;">‚ö†Ô∏è Reset Data Komplain</button>
  </div>

</div>

<script>
const { jsPDF } = window.jspdf;

// Show section & highlight menu aktif
function showSection(id){
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active-menu'));
  const btnMap = { 'absen': 0, 'hasil': 1, 'komplain': 2 };
  document.querySelectorAll('nav button')[btnMap[id]].classList.add('active-menu');
}

// Load card data
function loadCards(key, containerId, columns){
  const data = JSON.parse(localStorage.getItem(key)) || [];
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  data.forEach((item,index)=>{
    const card = document.createElement('div'); card.className='card';
    columns.forEach(col=>{
      if(col==='foto' && item[col]){
        card.innerHTML += `<p><strong>Foto:</strong><br><img src="${item[col]}" class="card-img"></p>`;
      } else {
        card.innerHTML += `<p><strong>${col}:</strong> ${item[col]}</p>`;
      }
    });
    container.appendChild(card);
  });
}

// Update PDF button visibility
function updatePDFButton(key, buttonId){
  const data = JSON.parse(localStorage.getItem(key)) || [];
  document.getElementById(buttonId).style.display = data.length > 0 ? 'inline-block' : 'none';
}

// Total pakaian
const bajuInput = document.getElementById('baju');
const celanaInput = document.getElementById('celana');
const jaketInput = document.getElementById('jaket');
const totalInput = document.getElementById('total');
function updateTotal(){ totalInput.value = (parseInt(bajuInput.value)||0)+(parseInt(celanaInput.value)||0)+(parseInt(jaketInput.value)||0); }
bajuInput.addEventListener('input', updateTotal);
celanaInput.addEventListener('input', updateTotal);
jaketInput.addEventListener('input', updateTotal);

// Reset buttons
const resetHasilBtn = document.getElementById('resetHasilLaundry');
const resetAbsenBtn = document.getElementById('resetAbsen');
const resetKomplainBtn = document.getElementById('resetKomplain');
function updateResetButtons(){
  const absenData = JSON.parse(localStorage.getItem('absen')) || [];
  const komplainData = JSON.parse(localStorage.getItem('komplain')) || [];
  const hasilData = JSON.parse(localStorage.getItem('hasilLaundry')) || [];
  resetAbsenBtn.style.display = absenData.length > 0 ? 'inline-block' : 'none';
  resetKomplainBtn.style.display = komplainData.length > 0 ? 'inline-block' : 'none';
  resetHasilBtn.style.display = hasilData.length > 0 ? 'inline-block' : 'none';
}

// --- Absen ---
document.getElementById('fotoAbsen').addEventListener('change', function(){
  const file = this.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(e){
      document.getElementById('fotoAbsenPreview').textContent = 'Foto dipilih';
      document.getElementById('fotoAbsenPreview').dataset.img = e.target.result;
    }
    reader.readAsDataURL(file);
  } else {
    document.getElementById('fotoAbsenPreview').textContent = '';
    document.getElementById('fotoAbsenPreview').dataset.img = '';
  }
});
document.getElementById('absenForm').addEventListener('submit', function(e){
  e.preventDefault();
  const nama = document.getElementById('namaPegawai').value;
  const tanggal = document.getElementById('tanggalAbsen').value;
  const jam = document.getElementById('jamAbsen').value;
  const foto = document.getElementById('fotoAbsenPreview').dataset.img || '';
  let data = JSON.parse(localStorage.getItem('absen')) || [];
  data.push({nama,tanggal,jam,foto});
  localStorage.setItem('absen', JSON.stringify(data));
  loadCards('absen','cardsAbsen',['nama','tanggal','jam','foto']);
  updatePDFButton('absen','simpanSemuaPDFAbsen');
  updateResetButtons();
  this.reset();
  document.getElementById('fotoAbsenPreview').textContent='';
  document.getElementById('fotoAbsenPreview').dataset.img='';
});

// --- Komplain ---
document.getElementById('fotoKomplain').addEventListener('change', function(){
  const file = this.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(e){
      document.getElementById('fotoPreview').textContent = 'Foto dipilih';
      document.getElementById('fotoPreview').dataset.img = e.target.result;
    }
    reader.readAsDataURL(file);
  } else {
    document.getElementById('fotoPreview').textContent = '';
    document.getElementById('fotoPreview').dataset.img = '';
  }
});
document.getElementById('komplainForm').addEventListener('submit', function(e){
  e.preventDefault();
  const nama = document.getElementById('namaPelanggan').value;
  const tanggal = document.getElementById('tanggalKomplain').value;
  const jam = document.getElementById('jamKomplain').value;
  const isi = document.getElementById('komplainText').value;
  const foto = document.getElementById('fotoPreview').dataset.img || '';
  let data = JSON.parse(localStorage.getItem('komplain')) || [];
  data.push({nama,tanggal,jam,isi,foto});
  localStorage.setItem('komplain', JSON.stringify(data));
  loadCards('komplain','cardsKomplain',['nama','tanggal','jam','isi','foto']);
  updatePDFButton('komplain','simpanSemuaPDFKomplain');
  updateResetButtons();
  this.reset();
  document.getElementById('fotoPreview').textContent='';
  document.getElementById('fotoPreview').dataset.img='';
});

// --- Hasil Laundry ---
document.getElementById('hasilForm').addEventListener('submit', function(e){
  e.preventDefault();
  const nama = document.getElementById('namaPelangganHasil').value;
  const berat = document.getElementById('beratLaundry').value;
  const baju = bajuInput.value;
  const celana = celanaInput.value;
  const jaket = jaketInput.value;
  const total = totalInput.value;
  const tanggalSelesai = document.getElementById('tanggalSelesai').value;
  const jamMulai = document.getElementById('jamMulai').value;
  const jamSelesai = document.getElementById('jamSelesai').value;
  let data = JSON.parse(localStorage.getItem('hasilLaundry')) || [];
  data.push({nama,berat,baju,celana,jaket,total,tanggalSelesai,jamMulai,jamSelesai});
  localStorage.setItem('hasilLaundry', JSON.stringify(data));
  loadCards('hasilLaundry','cardsHasilLaundry',['nama','berat','baju','celana','jaket','total','tanggalSelesai','jamMulai','jamSelesai']);
  updatePDFButton('hasilLaundry','simpanSemuaPDFHasil');
  updateResetButtons();
  this.reset(); totalInput.value='';
});

// Reset semua tombol
resetAbsenBtn.addEventListener('click', ()=>{if(confirm("‚ö†Ô∏è Hapus semua data Absen?")){localStorage.removeItem('absen'); loadCards('absen','cardsAbsen',['nama','tanggal','jam','foto']); updatePDFButton('absen','simpanSemuaPDFAbsen'); updateResetButtons();}});
resetHasilBtn.addEventListener('click', ()=>{if(confirm("‚ö†Ô∏è Hapus semua data Hasil Laundry?")){localStorage.removeItem('hasilLaundry'); loadCards('hasilLaundry','cardsHasilLaundry',['nama','berat','baju','celana','jaket','total','tanggalSelesai','jamMulai','jamSelesai']); updatePDFButton('hasilLaundry','simpanSemuaPDFHasil'); updateResetButtons();}});
resetKomplainBtn.addEventListener('click', ()=>{if(confirm("‚ö†Ô∏è Hapus semua data Komplain?")){localStorage.removeItem('komplain'); loadCards('komplain','cardsKomplain',['nama','tanggal','jam','isi','foto']); updatePDFButton('komplain','simpanSemuaPDFKomplain'); updateResetButtons();}});

// --- PDF Buttons ---
document.getElementById('simpanSemuaPDFAbsen').addEventListener('click', function(){
  const data = JSON.parse(localStorage.getItem('absen')) || [];
  if(data.length===0)return;
  const doc = new jsPDF();
  let y=20; doc.setFontSize(16); doc.text("Semua Data Absen JETWASH LAUNDRY",10,y); y+=10;
  doc.setFontSize(12);
  data.forEach((item,index)=>{
    if(y>270){ doc.addPage(); y=20; }
    doc.text(`${index+1}. Nama: ${item.nama}, Tanggal: ${item.tanggal}, Jam: ${item.jam}`,10,y); y+=7;
    if(item.foto){ doc.addImage(item.foto,'JPEG',10,y,50,50); y+=55; }
  });
  doc.save('Semua_Absen.pdf');
});
document.getElementById('simpanSemuaPDFHasil').addEventListener('click', function(){
  const data = JSON.parse(localStorage.getItem('hasilLaundry')) || [];
  if(data.length===0)return;
  const doc = new jsPDF();
  let y=20; doc.setFontSize(16); doc.text("Semua Hasil Laundry JETWASH LAUNDRY",10,y); y+=10;
  doc.setFontSize(12);
  data.forEach((item,index)=>{
    if(y>270){ doc.addPage(); y=20; }
    doc.text(`${index+1}. Nama: ${item.nama}, Berat: ${item.berat} kg, Baju:${item.baju}, Celana:${item.celana}, Jaket:${item.jaket}, Total:${item.total}, Tanggal Selesai:${item.tanggalSelesai}, Jam Mulai:${item.jamMulai}, Jam Selesai:${item.jamSelesai}`,10,y);
    y+=10;
  });
  doc.save('Semua_Hasil_Laundry.pdf');
});
document.getElementById('simpanSemuaPDFKomplain').addEventListener('click', function(){
  const data = JSON.parse(localStorage.getItem('komplain')) || [];
  if(data.length===0)return;
  const doc = new jsPDF();
  let y=20; doc.setFontSize(16); doc.text("Semua Data Komplain JETWASH LAUNDRY",10,y); y+=10;
  doc.setFontSize(12);
  data.forEach((item,index)=>{
    if(y>270){ doc.addPage(); y=20; }
    doc.text(`${index+1}. Nama: ${item.nama}, Tanggal: ${item.tanggal}, Jam: ${item.jam}`,10,y); y+=7;
    doc.text(`Isi: ${item.isi}`,10,y); y+=7;
    if(item.foto){ doc.addImage(item.foto,'JPEG',10,y,50,50); y+=55; }
  });
  doc.save('Semua_Komplain.pdf');
});

// Load all saved data on page load
document.addEventListener('DOMContentLoaded', function(){
  loadCards('absen','cardsAbsen',['nama','tanggal','jam','foto']);
  loadCards('hasilLaundry','cardsHasilLaundry',['nama','berat','baju','celana','jaket','total','tanggalSelesai','jamMulai','jamSelesai']);
  loadCards('komplain','cardsKomplain',['nama','tanggal','jam','isi','foto']);
  updatePDFButton('absen','simpanSemuaPDFAbsen');
  updatePDFButton('hasilLaundry','simpanSemuaPDFHasil');
  updatePDFButton('komplain','simpanSemuaPDFKomplain');
  updateResetButtons();
  showSection('absen');
});
</script>

</body>
</html>
