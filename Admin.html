<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard - Sea Laundry</title>
<style>
:root{--primary:#007bff;--bg:#f0f4f8;--card:#fff;--text:#2b2b2b;}
body{font-family:'Segoe UI',sans-serif;background:var(--bg);margin:0;padding:0;color:var(--text);}
.container{padding:20px;}
h1{color:var(--primary);}
table{width:100%;border-collapse:collapse;margin-top:14px;}
th,td{border:1px solid #ccc;padding:8px;text-align:left;}
th{background:#eee;}
input{padding:4px 6px;border-radius:4px;border:1px solid #ccc;}
button{padding:6px 12px;margin:2px;border-radius:6px;cursor:pointer;}
@media(max-width:600px){table,th,td{font-size:0.8em;}}
</style>
</head>
<body>
<div class="container">
<h1>Dashboard Admin</h1>
<table id="laundryTable">
<thead>
<tr>
<th>No</th>
<th>Nama</th>
<th>Alamat</th>
<th>No HP</th>
<th>Layanan</th>
<th>Catatan</th>
<th>Jadwal</th>
<th>Maps</th>
<th>Status</th>
<th>Aksi</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
function loadAdminData(){
  google.script.run.withSuccessHandler(function(data){
    const tbody=document.querySelector("#laundryTable tbody");
    tbody.innerHTML="";
    data.forEach((d,i)=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`
      <td>${i+1}</td>
      <td>${d.nama || ""}</td>
      <td>${d.alamat || ""}</td>
      <td>${d.nohp || ""}</td>
      <td>${d.layanan || ""}</td>
      <td>${d.catatan || ""}</td>
      <td>${d.jadwal || ""}</td>
      <td>${d.Maps || "" ? `<a href="${d.Maps}" target="_blank">Link</a>` : ""}</td>
      <td><input type="text" value="${d.Status || ""}" onchange="updateStatus(${i}, this.value)"></td>
      <td><button onclick="deleteRow(${i})">Hapus</button></td>`;
      tbody.appendChild(tr);
    });
  }).getAllLaundryData();
}

function updateStatus(index,value){
  google.script.run.withSuccessHandler(()=>{console.log("Update sukses")})
                   .updateLaundryData(index,"Status",value);
}

function deleteRow(index){
  if(confirm("Hapus data ini?")){
    google.script.run.withSuccessHandler(loadAdminData)
                     .updateLaundryData(index,"Status","Dihapus"); // contoh hapus -> ubah status
  }
}

window.onload=loadAdminData;
</script>
</body>
</html>
