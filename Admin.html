<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sea Laundry Admin</title>
<style>
  body { font-family:'Segoe UI', Tahoma, sans-serif; margin:0; background:#f9fafb; color:#1f2937; }
  h1 { text-align:center; padding:15px; }
  table { width:100%; border-collapse: collapse; margin:10px 0; }
  th, td { border:1px solid #ccc; padding:8px; text-align:left; }
  th { background:#3b82f6; color:white; }
  td input, td select { width: 100%; box-sizing:border-box; }
  @media(max-width:768px){ table, thead, tbody, th, td, tr { display:block; } 
    th { position: absolute; top:-9999px; left:-9999px; }
    td { border:none; position:relative; padding-left:50%; margin-bottom:10px; }
    td:before { position:absolute; top:0; left:6px; width:45%; padding-right:10px; white-space:nowrap; font-weight:bold; }
    td:nth-of-type(1):before { content:"Waktu"; } td:nth-of-type(2):before { content:"Nama"; }
    td:nth-of-type(3):before { content:"Alamat"; } td:nth-of-type(4):before { content:"No HP"; }
    td:nth-of-type(5):before { content:"Layanan"; } td:nth-of-type(6):before { content:"Catatan"; }
    td:nth-of-type(7):before { content:"Jadwal"; } td:nth-of-type(8):before { content:"Maps"; }
    td:nth-of-type(9):before { content:"Status"; }
  }
</style>
</head>
<body>
<h1>Sea Laundry Admin</h1>
<table id="ordersTable">
  <thead>
    <tr>
      <th>Waktu</th><th>Nama</th><th>Alamat</th><th>No HP</th>
      <th>Layanan</th><th>Catatan</th><th>Jadwal</th><th>Maps</th><th>Status</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
function renderOrders(orders){
  const tbody = document.querySelector("#ordersTable tbody");
  tbody.innerHTML = "";
  orders.forEach((o, i)=>{
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${new Date(o.timestamp).toLocaleString()}</td>
      <td><input value="${o.nama}" onchange="updateField(${i}, 'nama', this.value)"></td>
      <td><input value="${o.alamat}" onchange="updateField(${i}, 'alamat', this.value)"></td>
      <td><input value="${o.nohp}" onchange="updateField(${i}, 'nohp', this.value)"></td>
      <td><input value="${o.layanan}" onchange="updateField(${i}, 'layanan', this.value)"></td>
      <td><input value="${o.catatan}" onchange="updateField(${i}, 'catatan', this.value)"></td>
      <td><input value="${o.jadwal}" onchange="updateField(${i}, 'jadwal', this.value)"></td>
      <td>${o.mapsLink ? `<a href="${o.mapsLink}" target="_blank">Maps</a>` : ''}</td>
      <td>
        <select onchange="updateField(${i}, 'status', this.value)">
          <option value="Dipesan">Dipesan</option>
          <option value="Dijemput">Dijemput</option>
          <option value="Diproses">Diproses</option>
          <option value="Selesai">Selesai</option>
          <option value="Dibatalkan">Dibatalkan</option>
        </select>
      </td>
    `;
    tr.querySelector("select").value = o.status;
    tbody.appendChild(tr);
  });
}

function updateField(row, field, value){
  google.script.run.updateOrder(row, field, value);
}

// Load data saat halaman dibuka
google.script.run.withSuccessHandler(renderOrders).getOrders();
</script>
</body>
</html>
